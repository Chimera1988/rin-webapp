:root{
  --w: 840px;
  --pad: 14px;
  --gap: 10px;
  --radius: 16px;
  --bubble-max: 78%;
  --fz-regular: clamp(16px, 1.7vw, 17px); /* ≥16px — анти‑зум iOS */
  --fz-title: clamp(22px, 3.6vw, 28px);
}

* { box-sizing: border-box; }
html, body {
  height: 100%;
  margin: 0; padding: 0;
  background: #0b0f14; color: #e8eef7;
  -webkit-text-size-adjust: 100%;
}
body {
  font-family: -apple-system, system-ui, Segoe UI, Roboto, sans-serif;
  font-size: var(--fz-regular);
  min-height: 100dvh;
}

/* HEADER — Telegram минимализм */
.tg-header{
  position: sticky; top: 0; z-index: 5;
  display: flex; align-items: center; gap: 10px;
  padding: 12px calc(var(--pad) + env(safe-area-inset-right)) 12px calc(var(--pad) + env(safe-area-inset-left));
  background: #0e1520;
  border-bottom: 1px solid #1a2533;
}
.tg-header .tg-ico{
  appearance: none; border: 0; background: transparent;
  color: #9fb7d6; padding: 6px; border-radius: 10px;
}
.tg-peer{ display:flex; align-items:center; gap:10px; }
.avatar{
  width: 36px; height: 36px; border-radius: 50%; object-fit: cover;
  display:inline-block; background:#132033;
}
.avatar.small{ width:28px; height:28px; }
.avatar.small.spacer{ visibility:hidden; }
.peer-meta{ line-height:1.1; }
.peer-name{ font-weight:700; }
.peer-status{ font-size:12px; color:#80a0c2; }

/* APP */
.app {
  max-width: var(--w);
  margin: 0 auto;
  padding: 16px var(--pad) calc(100px + env(safe-area-inset-bottom));
  padding-left: calc(var(--pad) + env(safe-area-inset-left));
  padding-right: calc(var(--pad) + env(safe-area-inset-right));
}

/* CHAT */
.chat {
  display:flex; flex-direction:column; gap: var(--gap);
  min-height: 60svh; max-height: calc(100dvh - 200px);
  overflow:auto; padding: 8px 0;
  border-top: 1px solid #1a2533; border-bottom: 1px solid #1a2533;
  -webkit-overflow-scrolling: touch;
}
.row{ display:flex; gap:8px; }
.row.me{ justify-content:flex-end; }
.row.her{ justify-content:flex-start; }

.bubble{
  max-width: var(--bubble-max);
  padding: 12px 14px;
  border-radius: var(--radius);
  line-height: 1.38; white-space: pre-wrap; word-wrap: break-word;
}
.bubble.her{ background:#16263b; border:1px solid #243b5a; }
.bubble.me{  background:#2aabee; border:1px solid #2497d3; color:#fff; }

/* Date divider */
.date-divider{
  display:flex; justify-content:center; margin: 10px 0;
}
.date-divider span{
  font-size:12px; opacity:.75; padding:4px 10px; border-radius:20px;
  background:#0e1520; border:1px solid #1a2533;
}

/* typing */
.typing{ display:inline-flex; gap:6px; align-items:center; }
.typing span{ width:6px; height:6px; border-radius:50%; background:#9fb7d6; opacity:.4; animation: blink 1.2s infinite; }
.typing span:nth-child(2){ animation-delay:.2s; }
.typing span:nth-child(3){ animation-delay:.4s; }
@keyframes blink{ 0%,80%,100%{opacity:.2} 40%{opacity:1} }

/* INPUT BAR */
form{
  position: fixed; left: 0; right: 0; bottom: 0;
  margin: 0;
  padding: calc(10px + env(safe-area-inset-bottom))
           calc(var(--pad) + env(safe-area-inset-right))
           10px
           calc(var(--pad) + env(safe-area-inset-left));
  background: linear-gradient(180deg, rgba(11,15,20,.0) 0%, rgba(11,15,20,.85) 35%, rgba(11,15,20,.95) 100%);
  display:flex; gap:8px; align-items:center;
}
form #input{
  flex:1 1 auto; min-height:44px; font-size:16px; /* анти‑зум */
  padding:12px 14px; border-radius:12px; border:1px solid #2a4466;
  background:#0f1722; color:#e8eef7; outline:none;
}
form #send{
  flex:0 0 auto; min-width:54px; min-height:44px; font-size:16px; /* анти‑зум */
  padding:10px 12px; border-radius:12px; border:0;
  background:#2b79ff; color:#fff; font-weight:600;
  display:flex; align-items:center; justify-content:center;
}
form #send svg{ display:block; }
form #send:active{ transform: translateY(1px); }

@media (max-width:420px){
  :root{ --bubble-max: 86%; }
}

/* Light theme */
@media (prefers-color-scheme: light){
  body{ background:#f6f8fb; color:#0b172a; }
  .tg-header{ background:#ffffff; border-bottom-color:#e6eaf1; }
  .peer-status{ color:#6a7b91; }
  .chat{ border-color:#dde6f5; }
  .bubble.her{ background:#ffffff; border-color:#e6eef9; color:#0b172a; }
  .bubble.me{  background:#2aabee; border-color:#2497d3; color:#fff; }
  .date-divider span{ background:#ffffff; border-color:#e6eaf1; }
  form{ background: linear-gradient(180deg, rgba(246,248,251,0) 0%, rgba(246,248,251,.90) 35%, rgba(246,248,251,.98) 100%); }
  form #input{ background:#fff; color:#0b172a; border-color:#d3ddf0; }
}

::-webkit-scrollbar{ width:0; height:0; }
